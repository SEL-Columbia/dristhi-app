<div class="navbar navbar-fixed-top affected-by-sidepanel">
    <div class="navbar-inner">
        <ul class="nav pull-left">
            <li><img class="sidepanel-icon affected-by-sidepanel"><img class="separator"></li>
            <li><div class="name ellipsis">{{formatText coupleDetails.wifeName}}</div></li>
        </ul>

        <ul class="nav pull-right affected-by-sidepanel">
            <li><img class="separator"></li>
            <li data-modal-target="#pncFormModal"><img class="update-data"></li>
        </ul>
    </div>
</div>

<div id="pncFormModal" class="modal-content">
    <div class="modal-row" data-form="PNC_SERVICES" data-caseid="{{caseId}}">PNC visit</div>
    <div class="divider"></div>
    <div class="modal-row" data-form="CHILD_IMMUNIZATION" data-caseid="{{caseId}}">Child immunization</div>
    <div class="divider"></div>
    <div class="modal-row" data-form="PNC_CLOSE" data-caseid="{{caseId}}">Close PNC record</div>
</div>

<div id="content" class="content affected-by-sidepanel">
    <div class="registry-container container-fluid">
        <div class="row-fluid">
            <div class="span12">
                <ul class="client-details unstyled">
                    <li class="big-text">{{formatText coupleDetails.wifeName}}</li>
                    <li class="medium-text spacing-below">{{capitalize coupleDetails.husbandName}}</li>
                    <li>{{formatText location.villageName}}</li>
                    <li class="light-text">{{#if coupleDetails.isInArea}}EC No: {{coupleDetails.ecNumber}}, {{else}}Out of area, {{/if}}TC No: {{thaayiCardNumber}}</li>
                </ul>
            </div>
        </div>
    </div>

    <div id="todos" class="registry-container container-fluid">
        {{#each urgentTodos}}
            {{#if isCompleted}}
                <div class="alert alert-todo completed" data-form="{{formToOpen}}" data-caseid="{{../../caseId}}" data-visitcode="{{visitCode}}">
                    <div class="row-fluid">
                        <div class="span2">
                            <img class="todo-box checked"/>
                        </div>
                        <div class="span10 alert-todo-message">
                            <div class="detail">{{message}} done on {{formatDate todoDate}}</div>
                        </div>
                    </div>
                </div>
            {{else}}
                <div class="alert alert-todo overdue" data-form="{{formToOpen}}" data-caseid="{{../../caseId}}" data-visitcode="{{visitCode}}">
                    <div class="row-fluid">
                        <div class="span2">
                            <img class="todo-box"/>
                        </div>
                        <div class="span10 alert-todo-message">
                            <div class="detail">{{message}} due by {{formatDate todoDate}}</div>
                        </div>
                    </div>
                </div>
            {{/if}}
        {{/each}}
        {{#each todos}}
            {{#if isCompleted}}
                <div class="alert alert-todo completed" data-form="{{formToOpen}}" data-caseid="{{../../caseId}}" data-visitcode="{{visitCode}}">
                    <div class="row-fluid">
                        <div class="span2">
                            <img class="todo-box checked"/>
                        </div>
                        <div class="span10 alert-todo-message">
                            <div class="detail">{{message}} done on {{formatDate todoDate}}</div>
                        </div>
                    </div>
                </div>
            {{else}}
                <div class="alert alert-todo upcoming" data-form="{{formToOpen}}" data-caseid="{{../../caseId}}" data-visitcode="{{visitCode}}">
                    <div class="row-fluid">
                        <div class="span2">
                            <img class="todo-box"/>
                        </div>
                        <div class="span10 alert-todo-message">
                            <div class="detail">{{message}} due by {{formatDate todoDate}}</div>
                        </div>
                    </div>
                </div>
            {{/if}}
        {{/each}}

        <div class="divider"></div>
    </div>

    <div class="registry-container container-fluid">
        <div class="big-text row-fluid detail-section-header">
            Summary
        </div>
        <div class="well well-for-beneficiary-details-no-padding">
            <div class="container-fluid container-no-padding">
                <div class="row-fluid beneficiary-detail-component">
                    <div class="beneficiary-detail-content">
                        {{#ifFalse details.isHighRisk}}
                            <div class="big-text high-risk">
                                <i class="icon-circle-arrow-up" style="margin-top: 3px;"></i> High Risk</span>
                            </div>
                            <div class="beneficiary-detail-footer risk-detail-text"><ul>{{camelCaseAndConvertToListItems details.highRiskReason}}</ul></div>
                        {{else}}
                            <div class="text-center big-text normal-risk">Normal Risk</div>
                        {{/ifFalse}}
                    </div>
                    <div class="divider"></div>
                    <div class="beneficiary-detail-content">
                        <div class="span6 text-center right-border padded">
                            <span class="big-text">{{pncDetails.daysPostpartum}}</span><br><span class="meta-summary-text">Days Postpartum</span>
                        </div>
                        <div class="span6 text-center padded">
                            <span class="big-text">{{formatDate pncDetails.dateOfDelivery}}</span><br><span class="meta-summary-text">Date of Delivery</span>
                        </div>
                    </div>
                    {{#if details.deliveryComplications}}
                        <div class="row-fluid beneficiary-detail-component">
                            <div class="divider"></div>
                        </div>
                        <div class="row-fluid beneficiary-detail-component">
                            <div class="beneficiary-detail-content">
                                <b>Delivery Complications</b><br/>
                                <ul>{{camelCaseAndConvertToListItems details.deliveryComplications}}</ul>
                            </div>
                        </div>
                    {{/if}}
                </div>
            </div>
        </div>
    </div>

    <div class="registry-container container-fluid">
        <div class="big-text row-fluid detail-section-header">
            Timeline
        </div>
        <div class="well well-for-beneficiary-details-no-padding">
            <div class="container-fluid container-no-padding">
                {{#ifequal timelineEvents.length 0}}
                    <div class="row-fluid unavailable-data">
                        No medical history data available
                    </div>
                {{else}}
                    <div class="row-fluid beneficiary-detail-component">
                        <div class="beneficiary-detail-content">
                            <div class="timeline">
                                {{#each timelineEvents}}
                                    <div class="timeline-component row-fluid timelineEvent">
                                        <div class="span3 type {{this.type}}"></div>
                                        <div class="span5">
                                            <strong>{{title}}</strong><br>
                                            {{#each details}}
                                                {{{formatText this}}}<br>
                                            {{/each}}
                                        </div>
                                        <div class="span4 pull-right text-right">
                                            {{date}}
                                        </div>
                                    </div>
                                {{/each}}
                            </div>
                            <div class="container-section-component row-fluid show-more-button">
                                <div class = "divider"></div>
                                <div class = "expand"> Show more </div>
                            </div>
                        </div>
                    </div>
                {{/ifequal}}
            </div>
        </div>
    </div>
</div>
