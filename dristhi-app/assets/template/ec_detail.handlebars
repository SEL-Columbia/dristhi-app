<div class="navbar navbar-fixed-top affected-by-sidepanel">
    <div class="navbar-inner">
        <ul class="nav pull-left">
            <img class="sidepanel-icon affected-by-sidepanel"><img class="separator">
            <span class="name">EC</span>
        </ul>

        <ul class="nav pull-right affected-by-sidepanel">
            <li><img class="separator"></li>
            <li data-modal-target="#ecFormModal"><img class="update-data"></li>
        </ul>
    </div>
</div>

<div id="ecFormModal" class="modal-content">
    <div class="modal-row" data-form="EC_FP_UPDATE" data-caseid="{{caseId}}">Family planning update</div>
    <div class="divider"></div>
    <div class="modal-row" data-form="EC_FP_COMPLICATIONS" data-caseid="{{caseId}}">FP complications</div>
    <div class="divider"></div>
    <div class="modal-row" data-form="EC_REGISTER_ANC" data-caseid="{{caseId}}">Register as ANC</div>
    <div class="divider"></div>
    <div class="modal-row" data-form="EC_CLOSE" data-caseid="{{caseId}}">Close EC record</div>
</div>

<div id="content" class="content affected-by-sidepanel">
    <div class="registry-container container-fluid">
        <div class="row-fluid">
            <div class="span12">
                <ul class="client-details unstyled">
                    <li class="big-text">{{coupleDetails.wifeName}}</li>
                    <li class="medium-text spacing-below">{{coupleDetails.husbandName}}</li>
                    <li>{{capitalize village}}</li>
                    <li class="light-text">EC: {{ecNumber}}</li>
                </ul>
            </div>
        </div>
    </div>

    <div id="todos" class="registry-container container-fluid">
        {{#each urgentTodos}}
            {{#if isCompleted}}
                <div class="alert alert-todo completed" data-form="{{formToOpen}}" data-caseid="{{../../caseId}}" data-visitcode="{{visitCode}}">
                    <div class="row-fluid">
                        <div class="span2">
                            <img class="todo-box checked"/>
                        </div>
                        <div class="span10 alert-todo-message">
                            <div class="detail">{{message}} <span class="done-or-due"></span> on {{formatDate todoDate}}</div>
                        </div>
                    </div>
                </div>
            {{else}}
                <div class="alert alert-todo overdue" data-form="{{formToOpen}}" data-caseid="{{../../caseId}}" data-visitcode="{{visitCode}}">
                    <div class="row-fluid">
                        <div class="span2">
                            <img class="todo-box"/>
                        </div>
                        <div class="span10 alert-todo-message">
                            <div class="detail">{{message}} due by {{formatDate todoDate}}</div>
                        </div>
                    </div>
                </div>
            {{/if}}
        {{/each}}
        {{#each todos}}
            {{#if isCompleted}}
                <div class="alert alert-todo completed" data-form="{{formToOpen}}" data-caseid="{{../../caseId}}" data-visitcode="{{visitCode}}">
                    <div class="row-fluid">
                        <div class="span2">
                            <img class="todo-box checked"/>
                        </div>
                        <div class="span10 alert-todo-message">
                            <div class="detail">{{message}} done on {{formatDate todoDate}}</div>
                        </div>
                    </div>
                </div>
            {{else}}
                <div class="alert alert-todo upcoming" data-form="{{formToOpen}}" data-caseid="{{../../caseId}}" data-visitcode="{{visitCode}}">
                    <div class="row-fluid">
                        <div class="span2">
                            <img class="todo-box"/>
                        </div>
                        <div class="span10 alert-todo-message">
                            <div class="detail">{{message}} due by {{formatDate todoDate}}</div>
                        </div>
                    </div>
                </div>
            {{/if}}
        {{/each}}
        <div class="divider"></div>
    </div>

    <div class="registry-container container-fluid">
        <div class="big-text row-fluid detail-section-header">
            EC Summary
        </div>
        <div class="well well-for-beneficiary-details">
            <div class="container-fluid container-no-padding">
                <div class="row-fluid beneficiary-detail-component">
                    <div class="beneficiary-detail-header">Family Planning</div>
                    <div class="beneficiary-detail-content">
                        <i class="icon-ok"></i><span class="family-planning-current">{{details.currentMethod}}</span><br/>
                    </div>
                </div>

                <div class="row-fluid beneficiary-detail-component">
                    {{#ifNotZero children.length}}
                        <div class="divider divider-padding-top"></div>
                        <div class="beneficiary-detail-header">Children</div>
                        <div class="beneficiary-detail-content">
                        {{#each children}}
                            {{#if isFemale}}
                                <div class="ec-child girl">
                                    <div style="text-align: center;">
                                        <span style="font-weight: bold">Girl</span><br>
                                        {{age}}
                                    </div>
                                </div>
                            {{else}}
                                <div class="ec-child boy">
                                    <div style="text-align: center;">
                                        <span style="font-weight: bold;">Boy</span><br>
                                        {{age}}
                                    </div>
                                </div>
                            {{/if}}
                        {{/each}}
                        </div>
                    {{/ifNotZero}}
                </div>
            </div>
        </div>
    </div>

    <div class="registry-container container-fluid">
        <div class="big-text row-fluid detail-section-header">
            Timeline
        </div>
        <div class="well well-for-beneficiary-details">
            <div class="container-fluid container-no-padding">
                {{#ifequal timelineEvents.length 0}}
                    <div class="row-fluid unavailable-data">
                        No timeline data available
                    </div>
                {{else}}
                    <div class="row-fluid beneficiary-detail-component">
                        <div class="beneficiary-detail-content">
                            <div class="container-section container-fluid">
                                {{#each timelineEvents}}
                                    <div class="container-section-component row-fluid">
                                            <div class="timeline">
                                                <div class="span2 type {{this.type}}"></div>
                                                <div class="span6">
                                                    <strong>{{title}}</strong><br>
                                                    {{#each details}}
                                                        {{this}}<br>
                                                    {{/each}}
                                                </div>
                                                <div class="span4 pull-right text-right">
                                                    {{date}}
                                                </div>
                                            </div>
                                        </div>
                                {{/each}}
                            </div>
                        </div>
                    </div>
                {{/ifequal}}
            </div>
        </div>
    </div>
</div>
