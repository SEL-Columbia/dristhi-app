<div class="navbar navbar-fixed-top affected-by-sidepanel">
    <div class="navbar-inner">
        <ul class="nav pull-left">
            <li><img class="sidepanel-icon affected-by-sidepanel"><img class="separator"></li>
            <li>
                <div class="name ellipsis">{{formatText coupleDetails.wifeName}}</div>
            </li>
        </ul>

        <ul class="nav pull-right affected-by-sidepanel">
            <li><img class="separator"></li>
            <li data-modal-target="#ecFormModal"><img class="update-data"></li>
        </ul>
    </div>
</div>

<div id="ecFormModal" class="modal-content">
    <div class="modal-row" data-form="EC_FP_UPDATE" data-caseid="{{caseId}}">Family planning update</div>
    <div class="divider"></div>
    <div class="modal-row" data-form="EC_FP_COMPLICATIONS" data-caseid="{{caseId}}">FP complications</div>
    <div class="divider"></div>
    <div class="modal-row" data-form="EC_REGISTER_ANC" data-caseid="{{caseId}}">Register as ANC</div>
    <div class="divider"></div>
    <div class="modal-row" data-form="EC_CLOSE" data-caseid="{{caseId}}">Close EC record</div>
</div>

<div id="content" class="content-detail affected-by-sidepanel">
    <div class="status-bar affected-by-sidepanel">
        <span class="left-text">EC</span>
        {{#ifFalse isHighPriority}}
        <span class="right-text high-risk">High Priority</span>
        {{else}}
        <span class="right-text normal-risk">Normal Priority</span>
        {{/ifFalse}}
    </div>
    <div class="registry-container container-fluid">
        <div class="row-fluid">
            <div class="span12">
                <ul class="client-details unstyled">
                    <li class="big-text">{{formatText coupleDetails.wifeName}}</li>
                    <li class="medium-text spacing-below">{{capitalize coupleDetails.husbandName}}</li>
                    <li>{{formatText village}}</li>
                    <li class="light-text">EC No: {{ecNumber}}</li>
                </ul>
            </div>
        </div>
    </div>

    <div id="todos" class="registry-container container-fluid">
        {{#each urgentTodos}}
        {{#if isCompleted}}
        <div class="alert alert-todo completed" data-form="{{formToOpen}}" data-caseid="{{../../caseId}}" data-visitcode="{{visitCode}}">
            <div class="row-fluid">
                <div class="span2">
                    <img class="todo-box checked"/>
                </div>
                <div class="span10 alert-todo-message">
                    <div class="detail">{{message}} <span class="done-or-due"></span> on {{formatDate todoDate}}</div>
                </div>
            </div>
        </div>
        {{else}}
        <div class="alert alert-todo overdue" data-form="{{formToOpen}}" data-caseid="{{../../caseId}}" data-visitcode="{{visitCode}}">
            <div class="row-fluid">
                <div class="span2">
                    <img class="todo-box"/>
                </div>
                <div class="span10 alert-todo-message">
                    <div class="detail">{{message}} due by {{formatDate todoDate}}</div>
                </div>
            </div>
        </div>
        {{/if}}
        {{/each}}
        {{#each todos}}
        {{#if isCompleted}}
        <div class="alert alert-todo completed" data-form="{{formToOpen}}" data-caseid="{{../../caseId}}" data-visitcode="{{visitCode}}">
            <div class="row-fluid">
                <div class="span2">
                    <img class="todo-box checked"/>
                </div>
                <div class="span10 alert-todo-message">
                    <div class="detail">{{message}} done on {{formatDate todoDate}}</div>
                </div>
            </div>
        </div>
        {{else}}
        <div class="alert alert-todo upcoming" data-form="{{formToOpen}}" data-caseid="{{../../caseId}}" data-visitcode="{{visitCode}}">
            <div class="row-fluid">
                <div class="span2">
                    <img class="todo-box"/>
                </div>
                <div class="span10 alert-todo-message">
                    <div class="detail">{{message}} due by {{formatDate todoDate}}</div>
                </div>
            </div>
        </div>
        {{/if}}
        {{/each}}
        <div class="divider"></div>
    </div>

    <div class="registry-container container-fluid">
        <div class="big-text row-fluid detail-section-header">
            Summary
        </div>
        <div class="well well-for-beneficiary-details-no-padding">
            <div class="container-fluid container-no-padding">
                <div class="row-fluid beneficiary-detail-component">
                    <div class="beneficiary-detail-content">
                        {{#ifFalse isHighPriority}}
                        <div class="big-text high-risk">
                            <i class="icon-circle-arrow-up" style="margin-top: 3px;"></i> High Priority1</span>
                        </div>
                        <div class="beneficiary-detail-footer risk-detail-text">
                            <ul>{{camelCaseAndConvertToListItems details.highPriorityReason}}</ul>
                        </div>
                        {{else}}


                        <div class="text-center big-text normal-risk">Normal Priority</div>
                        {{/ifFalse}}
                    </div>
                </div>
            </div>
            <div class="container-fluid container-no-padding">
                <div class="row-fluid beneficiary-detail-component">
                    {{#ifNotZero children.length}}
                    <div class="divider divider-padding-bottom"></div>
                    <div class="beneficiary-detail-header">Children</div>
                    <div class="beneficiary-detail-content">
                        {{#each children}}
                        {{#if isFemale}}
                        <div class="ec-child girl">
                            <div style="text-align: center;">
                                <span style="font-weight: bold">Girl</span><br>
                                {{age}}
                            </div>
                        </div>
                        {{else}}
                        <div class="ec-child boy">
                            <div style="text-align: center;">
                                <span style="font-weight: bold;">Boy</span><br>
                                {{age}}
                            </div>
                        </div>
                        {{/if}}
                        {{/each}}
                    </div>
                    {{/ifNotZero}}
                </div>
            </div>
        </div>
    </div>

    <div class="registry-container container-fluid">
        <div class="big-text row-fluid detail-section-header">
            Family Planning
        </div>
        <div class="well well-for-beneficiary-details">
            <div class="container-fluid container-no-padding">
                <div class="row-fluid beneficiary-detail-component">
                    <div class="beneficiary-detail-content">
                        {{#ifequal details.currentMethod "none"}}
                        <i class="icon-remove"></i><span class="family-planning-label">Current</span><span class="family-planning-current">None</span><br/>
                        {{else}}
                        <i class="icon-ok"></i><span class="family-planning-label">Current</span><span class="family-planning-current">{{formatText details.currentMethod}}</span><br/>
                        {{/ifequal}}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="registry-container container-fluid">
        <div class="big-text row-fluid detail-section-header">
            Timeline
        </div>
        <div class="well well-for-beneficiary-details-no-padding">
            <div class="container-fluid container-no-padding">
                {{#ifequal timelineEvents.length 0}}
                <div class="row-fluid unavailable-data">
                    No medical history data available
                </div>
                {{else}}
                <div class="row-fluid beneficiary-detail-component">
                    <div class="beneficiary-detail-content">
                        <div class="timeline">
                            {{#each timelineEvents}}
                            <div class="timeline-component row-fluid timelineEvent">
                                <div class="span3 type {{this.type}}"></div>
                                <div class="span5">
                                    <strong>{{title}}</strong><br>
                                    {{#each details}}
                                    {{{formatText this}}}<br>
                                    {{/each}}
                                </div>
                                <div class="span4 pull-right text-right">
                                    {{date}}
                                </div>
                            </div>
                            {{/each}}
                        </div>
                        <div class="container-section-component row-fluid show-more-button">
                            <div class="divider"></div>
                            <div class="expand"> Show more</div>
                        </div>
                    </div>
                </div>
                {{/ifequal}}
            </div>
        </div>
    </div>
</div>
